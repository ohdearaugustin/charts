# Default values for headscale.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: headscale/headscale
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  # tag: "0.13.0"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

service:
  type: LoadBalancer
  # Default ports used from listen_addr
  # To overwrite use
  # http_port: 80
  # Default ports used from metrics_listen_addr
  # To overwrite use
  # metrics_port: 9090
  # Default ports used from grpc_listen_addr
  # To overwrite use
  # grpc_port: 50443
  # Default ports used from stun_listen_addr
  # To overwrite use
  # derp_port: 3478

resources: {}
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

storage:
  class: standard
  size: 1Gi

# Be aware through the use of templates to generate the configuration
# helm will sort the config values by the alpabet.
headscale:
  # Use debug image
  debug: false
  # Set private_key_path in config to autogenerate key
  # private_key:
  #   key: "privkey:<key>"
  # private_key:
  #   existing_secret: headscale-key
  # To use derp also set the derp.path in the configuration
  # derp:
  #   regions:
  #     900:
  #       regionid: 900
  #       regioncode: custom
  #       regionname: My Region
  #       nodes:
  #         - name: 900a
  #           regionid: 900
  #           hostname: myderp.mydomain.no
  #           ipv4: 123.123.123.123
  #           ipv6: "2604:a880:400:d1::828:b001"
  #           stunport: 0
  #           stunonly: false
  #           derpport: 0
  config:
   server_url: http://example.com
   listen_addr: 0.0.0.0:80
   metrics_listen_addr: 127.0.0.1:9090
   grpc_listen_addr: 0.0.0.0:50443
   grpc_allow_insecure: false
   private_key_path: /var/lib/headscale/private.key
   noise:
     private_key_path: /var/lib/headscale/noise_private.key
   ip_prefixes:
     - fd7a:115c:a1e0::/48
     - 100.64.0.0/10
   derp:
     server:
       enabled: false
       region_id: 999
       region_code: "headscale"
       region_name: "Headscale Embedded DERP"
       stun_listen_addr: "0.0.0.0:3478"
     urls:
       - https://controlplane.tailscale.com/derpmap/default
     path: []
     auto_update_enabled: true
     update_frequency: 24h
   disable_check_updates: false
   ephemeral_node_inactivity_timeout: 30m
   db_type: sqlite3
   db_path: /var/lib/headscale/db.sqlite
   acme_url: https://acme-v02.api.letsencrypt.org/directory
   acme_email: ""
   tls_letsencrypt_hostname: ""
   tls_client_auth_mode: relaxed
   tls_letsencrypt_cache_dir: /var/lib/headscale/cache
   tls_letsencrypt_challenge_type: HTTP-01
   tls_letsencrypt_listen: ":http"
   tls_cert_path: ""
   tls_key_path: ""
   log_level: info
   acl_policy_path: ""
   dns_config:
     nameservers:
       - 1.1.1.1
     domains: []
     magic_dns: true
     base_domain: example.com
   unix_socket: /var/run/headscale.sock
   unix_socket_permission: "0770"
   logtail:
     enabled: false
   randomize_client_port: false
